version: '3.7'
services:
  weprint:
    image: ${DOCKER_REGISTRY-}weprint/weprint:${BUILD_BUILDNUMBER:-latest}
    build:
      context: ../src
      dockerfile: WePrint/Dockerfile
    depends_on:
      - ravendb
  
  ravendb:
    image: ravendb/ravendb
    ports:
      - target: 8080
        published: 8080
        protocol: tcp
        mode: host
        
      - target: 38888
        published: 38888
        protocol: tcp
        mode: host
    deploy:
      endpoint_mode: dnsrr
        
    volumes:
      - raven-data:/opt/RavenDB/Server/RavenData

#  rabbitmq:
#    image: rabbitmq/rabbitmq:management
#    ports:
#      - 15672:15672

volumes:
  raven-data:
